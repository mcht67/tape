schema: '2.0'
stages:
  load_raw_data:
    cmd: python source/load_raw_data.py
    deps:
    - path: source/load_raw_data.py
      hash: md5
      md5: 5fe74d547fe917f7bad8ff4d32b65c5e
      size: 634
    params:
      params.yaml:
        dataset.name: DBD-research-group/BirdSet
        dataset.sampling_rate: 32000
        dataset.split: train
        dataset.subset: HSN_xc
        general.random_seed: 42
    outs:
    - path: data/raw_datasets/HSN_xc
      hash: md5
      md5: d01d5e89fb41f6b671e7899f6bd2683b.dir
      size: 6165234713
      nfiles: 10
  mix_audio:
    cmd: python source/mix_audio.py
    deps:
    - path: data/raw_datasets/HSN_xc
      hash: md5
      md5: d01d5e89fb41f6b671e7899f6bd2683b.dir
      size: 6165234713
      nfiles: 10
    - path: source/mix_audio.py
      hash: md5
      md5: 502cbf2241cd365474eac13730c37aa3
      size: 6503
    params:
      params.yaml:
        dataset.max_polyphony_degree: 7
        dataset.name: DBD-research-group/BirdSet
        dataset.sampling_rate: 32000
        dataset.segment_duration: 5
        dataset.split: train
        general.random_seed: 42
    outs:
    - path: data/polyphonic_datasets/HSN_xc_polyphonic
      hash: md5
      md5: b4ab585905b83da08d0b8ec931bee2ba.dir
      size: 24634852664
      nfiles: 52
  preprocess:
    cmd: python source/preprocess.py
    deps:
    - path: data/polyphonic_datasets/HSN_xc_polyphonic
      hash: md5
      md5: b4ab585905b83da08d0b8ec931bee2ba.dir
      size: 24634852664
      nfiles: 52
    - path: source/preprocess.py
      hash: md5
      md5: bdab6f29755540adf01d6a2ed9e11d9d
      size: 5546
    params:
      params.yaml:
        embeddings.feature: audio
        embeddings.models:
        - perch_8
        - yamnet
    outs:
    - path: data/preprocessed_datasets/HSN_xc_preprocessed
      hash: md5
      md5: 9e8f3be3a5fa399265089ec813d13f01.dir
      size: 24950313722
      nfiles: 52
  train:
    cmd: python source/train.py
    deps:
    - path: data/preprocessed_datasets/HSN_xc_preprocessed
      hash: md5
      md5: 9e8f3be3a5fa399265089ec813d13f01.dir
      size: 24950313722
      nfiles: 52
    - path: source/train.py
      hash: md5
      md5: 600ec1b37034a901a9bb3e57cd1ac43b
      size: 7713
    params:
      params.yaml:
        general.random_seed: 42
        train.batch_size: 32
        train.epochs: 5
        train.features: perch_8_embeddings
        train.labels: polyphony_degree
        train.pooling_strategy: mean
        train.test_split: 0.1
        train.val_split: 0.1
